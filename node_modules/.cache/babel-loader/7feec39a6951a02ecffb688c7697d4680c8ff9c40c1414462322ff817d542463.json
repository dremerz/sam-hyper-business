{"ast":null,"code":"import _toConsumableArray from\"C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js\";import _regeneratorRuntime from\"C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _objectSpread from\"C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _asyncToGenerator from\"C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import React,{useEffect,useState}from'react';import{initializeApp}from'firebase/app';import{getFirestore,collection,getDocs,doc,addDoc}from'firebase/firestore/lite';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var firebaseConfig={apiKey:\"AIzaSyA95pWNegQN52jOC8gB2cs9s2BRMHbERR4\",authDomain:\"sam-hyper-business.firebaseapp.com\",projectId:\"sam-hyper-business\",storageBucket:\"sam-hyper-business.appspot.com\",messagingSenderId:\"644102757906\",appId:\"1:644102757906:web:50d98f81cb35e9e52842cb\",measurementId:\"G-F6J99L8CHG\"};var app=initializeApp(firebaseConfig);var db=getFirestore(app);export default function TakeAttendance(){var _useState=useState([\"\"]),_useState2=_slicedToArray(_useState,2),employeeData=_useState2[0],setEmployeeData=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),attendanceData=_useState4[0],setAttendanceData=_useState4[1];// Initialize attendanceData with an empty array\nuseEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var itemsCol,itemSnapshot,data;return _regeneratorRuntime().wrap(function _callee$(_context){while(1)switch(_context.prev=_context.next){case 0:itemsCol=collection(db,'employeeDetails');_context.next=3;return getDocs(itemsCol);case 3:itemSnapshot=_context.sent;data=itemSnapshot.docs.map(function(doc){return _objectSpread({id:doc.id},doc.data());});setEmployeeData(data);case 6:case\"end\":return _context.stop();}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[]);var handleAttendanceChange=function handleAttendanceChange(e,id){if(e.target.checked){// Mark employee as absent\nsetAttendanceData(function(prevAttendance){return[].concat(_toConsumableArray(prevAttendance),[id]);});}else{// Mark employee as present\nsetAttendanceData(function(prevAttendance){return prevAttendance.filter(function(absentId){return absentId!==id;});});}};var handleSubmitAttendance=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(e){var attendanceCol,date,attendanceDataArray;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1)switch(_context2.prev=_context2.next){case 0:e.preventDefault();_context2.prev=1;attendanceCol=collection(db,'employeeAttendance');date=new Date().toISOString();// Loop through all employees and add their data to the attendanceData array\nattendanceDataArray=employeeData.map(function(employee){var attendanceStatus=attendanceData.includes(employee.id)?'absent':'present';return{name:employee.fullName,employeeid:employee.employeeId,attendance:attendanceStatus,date:date};});// Add the attendance data to the \"employeeAttendance\" collection one by one\n_context2.next=7;return Promise.all(attendanceDataArray.map(function(data){return addDoc(attendanceCol,data);}));case 7:// Reset the attendanceData state after saving\nsetAttendanceData([]);alert('Attendance saved successfully!');_context2.next=15;break;case 11:_context2.prev=11;_context2.t0=_context2[\"catch\"](1);console.error('Error saving attendance:',_context2.t0);alert('Error saving attendance. Please try again.');case 15:case\"end\":return _context2.stop();}},_callee2,null,[[1,11]]);}));return function handleSubmitAttendance(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(\"div\",{className:\"dashboard-content-one\",id:\"cont-1\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"breadcrumbs-area\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"  Take Employee Attendance\"})}),/*#__PURE__*/_jsx(\"div\",{className:\"card height-auto\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"card-body\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"heading-layout1\"}),/*#__PURE__*/_jsxs(\"table\",{className:\"table display data-table text-nowrap\",children:[/*#__PURE__*/_jsx(\"thead\",{children:/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"th\",{children:\"S.No\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Full Name\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Employee ID\"}),/*#__PURE__*/_jsx(\"th\",{children:\"Absent\"})]})}),/*#__PURE__*/_jsx(\"tbody\",{children:employeeData!=\"\"?employeeData.map(function(employee,index){return/*#__PURE__*/_jsxs(\"tr\",{children:[/*#__PURE__*/_jsx(\"td\",{children:index+1}),/*#__PURE__*/_jsx(\"td\",{children:employee.fullName}),/*#__PURE__*/_jsx(\"td\",{children:employee.employeeId}),/*#__PURE__*/_jsx(\"td\",{children:/*#__PURE__*/_jsx(\"input\",{type:\"checkbox\",checked:attendanceData.includes(employee.id),onChange:function onChange(e){return handleAttendanceChange(e,employee.id);}})})]},employee.id);}):\"Loading...\"})]}),/*#__PURE__*/_jsx(\"div\",{style:{textAlign:\"right\",alignItems:\"right\"},children:/*#__PURE__*/_jsx(\"button\",{onClick:handleSubmitAttendance,children:\"Save Attendance\"})})]})})]});}","map":{"version":3,"names":["React","useEffect","useState","initializeApp","getFirestore","collection","getDocs","doc","addDoc","jsx","_jsx","jsxs","_jsxs","firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","app","db","TakeAttendance","_useState","_useState2","_slicedToArray","employeeData","setEmployeeData","_useState3","_useState4","attendanceData","setAttendanceData","fetchData","_ref","_asyncToGenerator","_regeneratorRuntime","mark","_callee","itemsCol","itemSnapshot","data","wrap","_callee$","_context","prev","next","sent","docs","map","_objectSpread","id","stop","apply","arguments","handleAttendanceChange","e","target","checked","prevAttendance","concat","_toConsumableArray","filter","absentId","handleSubmitAttendance","_ref2","_callee2","attendanceCol","date","attendanceDataArray","_callee2$","_context2","preventDefault","Date","toISOString","employee","attendanceStatus","includes","name","fullName","employeeid","employeeId","attendance","Promise","all","alert","t0","console","error","_x","className","children","index","type","onChange","style","textAlign","alignItems","onClick"],"sources":["C:/Aravind/Clients/Sam-Hyper-Business/PayRoll-Software/dremerz-payrollsoftware/src/Takeattendance.jsx"],"sourcesContent":["import React, { useEffect, useState } from 'react';\r\nimport { initializeApp } from 'firebase/app';\r\nimport { getFirestore, collection, getDocs, doc, addDoc } from 'firebase/firestore/lite';\r\n\r\nconst firebaseConfig = {\r\n  apiKey: \"AIzaSyA95pWNegQN52jOC8gB2cs9s2BRMHbERR4\",\r\n  authDomain: \"sam-hyper-business.firebaseapp.com\",\r\n  projectId: \"sam-hyper-business\",\r\n  storageBucket: \"sam-hyper-business.appspot.com\",\r\n  messagingSenderId: \"644102757906\",\r\n  appId: \"1:644102757906:web:50d98f81cb35e9e52842cb\",\r\n  measurementId: \"G-F6J99L8CHG\"\r\n};\r\n\r\nconst app = initializeApp(firebaseConfig);\r\nconst db = getFirestore(app);\r\n\r\nexport default function TakeAttendance() {\r\n  const [employeeData, setEmployeeData] = useState([\"\"]);\r\n  const [attendanceData, setAttendanceData] = useState([]); // Initialize attendanceData with an empty array\r\n\r\n  useEffect(() => {\r\n    const fetchData = async () => {\r\n      const itemsCol = collection(db, 'employeeDetails');\r\n      const itemSnapshot = await getDocs(itemsCol);\r\n      const data = itemSnapshot.docs.map((doc) => ({ id: doc.id, ...doc.data() }));\r\n      setEmployeeData(data);\r\n    };\r\n\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleAttendanceChange = (e, id) => {\r\n    if (e.target.checked) {\r\n      // Mark employee as absent\r\n      setAttendanceData((prevAttendance) => [...prevAttendance, id]);\r\n    } else {\r\n      // Mark employee as present\r\n      setAttendanceData((prevAttendance) => prevAttendance.filter((absentId) => absentId !== id));\r\n    }\r\n  };\r\n\r\n  const handleSubmitAttendance = async (e) => {\r\n    e.preventDefault();\r\n\r\n    try {\r\n      const attendanceCol = collection(db, 'employeeAttendance');\r\n      const date = new Date().toISOString();\r\n\r\n      // Loop through all employees and add their data to the attendanceData array\r\n      const attendanceDataArray = employeeData.map((employee) => {\r\n        const attendanceStatus = attendanceData.includes(employee.id) ? 'absent' : 'present';\r\n        return {\r\n          name: employee.fullName,\r\n          employeeid: employee.employeeId,\r\n          attendance: attendanceStatus,\r\n          date: date,\r\n        };\r\n      });\r\n\r\n      // Add the attendance data to the \"employeeAttendance\" collection one by one\r\n      await Promise.all(attendanceDataArray.map((data) => addDoc(attendanceCol, data)));\r\n\r\n      // Reset the attendanceData state after saving\r\n      setAttendanceData([]);\r\n\r\n      alert('Attendance saved successfully!');\r\n    } catch (error) {\r\n      console.error('Error saving attendance:', error);\r\n      alert('Error saving attendance. Please try again.');\r\n    }\r\n  };\r\n\r\n\r\n  return (\r\n    <div className=\"dashboard-content-one\" id=\"cont-1\">\r\n       <div className=\"breadcrumbs-area\">\r\n    <h3>  Take Employee Attendance</h3>\r\n   \r\n  </div>\r\n\r\n  <div className=\"card height-auto\">\r\n    <div className=\"card-body\">\r\n      <div className=\"heading-layout1\">\r\n        \r\n        \r\n      </div>\r\n      <table className=\"table display data-table text-nowrap\">\r\n        <thead>\r\n          <tr>\r\n            <th>S.No</th>\r\n            <th>Full Name</th>\r\n            <th>Employee ID</th>\r\n            <th>Absent</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody>\r\n          {employeeData!=\"\"? employeeData.map((employee, index) => (\r\n            <tr key={employee.id}>\r\n              <td>{index + 1}</td>\r\n              <td>{employee.fullName}</td>\r\n              <td>{employee.employeeId}</td>\r\n              <td>\r\n                <input\r\n                  type=\"checkbox\"\r\n                  checked={attendanceData.includes(employee.id)}\r\n                  onChange={(e) => handleAttendanceChange(e, employee.id)}\r\n                />\r\n              </td>\r\n            </tr>\r\n          )):\"Loading...\"}\r\n        </tbody>\r\n      </table>\r\n      <div style={{textAlign:\"right\",alignItems:\"right\"}}>\r\n      <button  onClick={handleSubmitAttendance}>Save Attendance</button>\r\n\r\n      </div>\r\n    </div>\r\n    </div></div>\r\n  );\r\n}\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}